<div class="page">
  <div class="header">
    <div>
      <h1>Route parser</h1>
      <p class="subtitle">Crop incoming per player in the next hour</p>
    </div>
  </div>

  <div class="card">
    <label for="input">Paste incoming deliveries</label>

    <textarea
      id="input"
      placeholder="Paste the Travian incoming deliveries text here…"
      rows="14"
      (input)="inputText = $any($event.target).value"
    ></textarea>

    <div class="meta">
      <button class="btn" (click)="parse()">Parse next hour</button>
    </div>
  </div>

  <div class="card">
    <label for="troops">Paste troop overview (consumption)</label>

    <textarea
      id="troops"
      placeholder="Paste the 'Troops in this village and its oases' overview here…"
      rows="14"
      (input)="troopText = $any($event.target).value"
    ></textarea>

    <div class="meta">
      <button class="btn" (click)="parse()">Parse next hour</button>
    </div>
  </div>

  <div class="card" *ngIf="rows.length">
    <table class="tbl" *ngIf="rows.length">
      <thead>
        <tr>
          <th>Player</th>
          <th class="num">Incoming crop (≤ 1h)</th>
          <th class="num">Consumption / hour</th>
          <th class="num">Net (in - cons)</th>
          <th class="num">Deliveries</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let r of rows" [class.total]="r.player === 'TOTAL'">
          <td>{{ r.player }}</td>
          <td class="num">{{ r.incomingCrop }}</td>
          <td class="num">{{ r.consumption }}</td>
          <td class="num">{{ r.net }}</td>
          <td class="num">{{ r.deliveries }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <details class="howto">
    <summary>How to use</summary>
    <div class="howto-body">
      <ol>
        <li>Open Travian → marketplace → <b>Expand Incoming deliveries</b>.</li>
        <li>Select all and copy (ctrl+a, ctrl+c).</li>
        <li>Paste into the first textbox above.</li>
        <li>Click <b>Parse next hour</b> to see crop totals per player.</li>
        <li>
          Go into rally point, troops in village. Ctrl+a, ctrl+c in the second
          textbox
        </li>
      </ol>
    </div>
  </details>
</div>
